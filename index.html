<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HexenjÃ¤ger Dashboard</title>
  <style>
    :root {
      --bg: #0f172a; --text: #e5e7eb; --muted: #9ca3af; 
      --border: #1f2937; --accent: #7c3aed; --accent2: #06b6d4;
      --card: rgba(255,255,255,0.05);
    }
    *{box-sizing:border-box; margin:0; padding:0;}
    body{margin:0; background:var(--bg); color:var(--text); font-family:system-ui; padding:20px;}
    .container{max-width:1200px; margin:0 auto;}
    .header{text-align:center; margin-bottom:30px;}
    h1{font-size:2.5em; margin-bottom:10px; background:linear-gradient(90deg,var(--accent),var(--accent2)); -webkit-background-clip:text; color:transparent;}
    
    .nav{display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin:20px 0;}
    .nav a{padding:12px 20px; background:var(--card); border:1px solid var(--border); border-radius:10px; text-decoration:none; color:var(--text); transition:0.2s;}
    .nav a:hover{background:var(--accent); transform:translateY(-2px);}
    
    .stats{display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:20px; margin:30px 0;}
    .stat-card{background:var(--card); border:1px solid var(--border); border-radius:15px; padding:20px; text-align:center;}
    .stat-number{font-size:2em; font-weight:bold; color:var(--accent2);}
    
    .login-section{text-align:center; margin:30px 0; padding:20px; background:var(--card); border-radius:15px;}
    .login-inputs{display:inline-flex; gap:10px; margin:15px 0;}
    input{padding:10px; border-radius:8px; border:1px solid var(--border); background:rgba(0,0,0,0.3); color:var(--text);}
    button{padding:10px 20px; background:var(--accent); color:white; border:none; border-radius:8px; cursor:pointer;}
    
    .admin-only{display:none;}
    body.admin .admin-only{display:block;}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>HexenjÃ¤ger Dashboard</h1>
      <p>Familie Â· Respekt Â· Gemeinschaft</p>
    </div>

    <!-- Navigation -->
    <div class="nav">
      <a href="auszahlung.html">ðŸ’° Auszahlungen</a>
      <a href="statistik.html">ðŸ“Š Statistik</a>
      <a href="events.html" class="admin-only">ðŸ“… Events</a>
      <a href="mitglieder.html" class="admin-only">ðŸ‘¥ Mitglieder</a>
    </div>

    <!-- Login Bereich -->
    <div class="login-section">
      <h3>Leaderschaft Login</h3>
      <div class="login-inputs">
        <input type="email" id="email" placeholder="E-Mail">
        <input type="password" id="password" placeholder="Passwort">
        <button onclick="login()">Login</button>
        <button onclick="logout()" style="display:none; background:#ef4444;" id="logoutBtn">Logout</button>
      </div>
      <p id="loginStatus">Nicht eingeloggt</p>
    </div>

    <!-- Statistik Overview -->
    <div class="stats">
      <div class="stat-card">
        <div class="stat-number" id="totalMembers">0</div>
        <div>Aktive Mitglieder</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="totalPayouts">0 â‚¬</div>
        <div>Gesamte Auszahlungen</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="openPayouts">0 â‚¬</div>
        <div>Offene Auszahlungen</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="recentEvents">0</div>
        <div>Events (7 Tage)</div>
      </div>
    </div>

    <!-- Letzte AktivitÃ¤ten -->
    <div class="stat-card">
      <h3>Letzte AktivitÃ¤ten</h3>
      <div id="recentActivities">Lade AktivitÃ¤ten...</div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  
  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyCB909WgDGPh1KE6lMpZshQ1BmzoTYR2Ic",
      authDomain: "hexenjaeger-dashboard.firebaseapp.com",
      projectId: "hexenjaeger-dashboard",
      storageBucket: "hexenjaeger-dashboard.firebasestorage.app",
      messagingSenderId: "48507598074",
      appId: "1:48507598074:web:d736c118fd74d1968d0543"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Login/Logout
    async function login() {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        await auth.signInWithEmailAndPassword(email, password);
      } catch (error) {
        alert('Login fehlgeschlagen: ' + error.message);
      }
    }

    async function logout() {
      await auth.signOut();
    }

    auth.onAuthStateChanged(user => {
      document.body.classList.toggle('admin', !!user);
      document.getElementById('logoutBtn').style.display = user ? 'inline-block' : 'none';
      document.getElementById('loginStatus').textContent = user ? 'Eingeloggt als ' + user.email : 'Nicht eingeloggt';
    });

    // Daten laden
    db.collection('members').onSnapshot(snap => {
      let total = 0;
      snap.forEach(doc => total++);
      document.getElementById('totalMembers').textContent = total;
    });

    db.collection('transactions').where('type', '==', 'auszahlung').onSnapshot(snap => {
      let total = 0;
      snap.forEach(doc => total += doc.data().amount || 0);
      document.getElementById('totalPayouts').textContent = total.toLocaleString('de-DE') + ' â‚¬';
    });
  </script>
</body>
</html>
